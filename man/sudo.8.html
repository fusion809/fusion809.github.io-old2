<!DOCTYPE html>
<html>
<head>
<meta charset="utf-8"/>
<style>
table.head, table.foot { width: 100%; }
td.head-rtitle, td.foot-os { text-align: right; }
td.head-vol { text-align: center; }
table.foot td { width: 50%; }
table.head td { width: 33%; }
div.spacer { margin: 1em 0; }
</style>
<title>
SUDO(8)</title>
</head>
<body>
<div class="mandoc">
<div class="section">
<h1 id="x4e414d45">NAME</h1> <b class="name">sudo</b>, <b class="name">sudoedit</b> &#8212; <span class="desc">execute a command as another user</span></div>
<div class="section">
<h1 id="x53594e4f50534953">SYNOPSIS</h1><table class="synopsis">
<col style="width: 4.00ex;"/>
<col/>
<tbody>
<tr>
<td>
sudo</td>
<td>
<b class="flag">-h</b> | <b class="flag">-K</b> | <b class="flag">-k</b> | <b class="flag">-V</b></td>
</tr>
</tbody>
</table>
<br/>
<table class="synopsis">
<col style="width: 4.00ex;"/>
<col/>
<tbody>
<tr>
<td>
sudo</td>
<td>
<b class="flag">-v</b> [<span class="opt"><b class="flag">-AknS</b></span>] [<span class="opt"><b class="flag">-a</b> <i class="arg">type</i></span>] [<span class="opt"><b class="flag">-g</b> <i class="arg">group</i></span>] [<span class="opt"><b class="flag">-h</b> <i class="arg">host</i></span>] [<span class="opt"><b class="flag">-p</b> <i class="arg">prompt</i></span>] [<span class="opt"><b class="flag">-u</b> <i class="arg">user</i></span>]</td>
</tr>
</tbody>
</table>
<br/>
<table class="synopsis">
<col style="width: 4.00ex;"/>
<col/>
<tbody>
<tr>
<td>
sudo</td>
<td>
<b class="flag">-l</b> [<span class="opt"><b class="flag">-AknS</b></span>] [<span class="opt"><b class="flag">-a</b> <i class="arg">type</i></span>] [<span class="opt"><b class="flag">-g</b> <i class="arg">group</i></span>] [<span class="opt"><b class="flag">-h</b> <i class="arg">host</i></span>] [<span class="opt"><b class="flag">-p</b> <i class="arg">prompt</i></span>] [<span class="opt"><b class="flag">-U</b> <i class="arg">user</i></span>] [<span class="opt"><b class="flag">-u</b> <i class="arg">user</i></span>] [<span class="opt"><i class="arg">command</i></span>]</td>
</tr>
</tbody>
</table>
<br/>
<table class="synopsis">
<col style="width: 4.00ex;"/>
<col/>
<tbody>
<tr>
<td>
sudo</td>
<td>
[<span class="opt"><b class="flag">-AbEHnPS</b></span>] [<span class="opt"><b class="flag">-a</b> <i class="arg">type</i></span>] [<span class="opt"><b class="flag">-C</b> <i class="arg">num</i></span>] [<span class="opt"><b class="flag">-c</b> <i class="arg">class</i></span>] [<span class="opt"><b class="flag">-g</b> <i class="arg">group</i></span>] [<span class="opt"><b class="flag">-h</b> <i class="arg">host</i></span>] [<span class="opt"><b class="flag">-p</b> <i class="arg">prompt</i></span>] [<span class="opt"><b class="flag">-r</b> <i class="arg">role</i></span>] [<span class="opt"><b class="flag">-t</b> <i class="arg">type</i></span>] [<span class="opt"><b class="flag">-u</b> <i class="arg">user</i></span>] [<span class="opt"><i class="arg">VAR</i>=<i class="arg">value</i></span>] [<span class="opt"><b class="flag">-i</b> | <b class="flag">-s</b></span>] [<span class="opt"><i class="arg">command</i></span>]</td>
</tr>
</tbody>
</table>
<br/>
<table class="synopsis">
<col style="width: 4.00ex;"/>
<col/>
<tbody>
<tr>
<td>
sudoedit</td>
<td>
[<span class="opt"><b class="flag">-AknS</b></span>] [<span class="opt"><b class="flag">-a</b> <i class="arg">type</i></span>] [<span class="opt"><b class="flag">-C</b> <i class="arg">num</i></span>] [<span class="opt"><b class="flag">-c</b> <i class="arg">class</i></span>] [<span class="opt"><b class="flag">-g</b> <i class="arg">group</i></span>] [<span class="opt"><b class="flag">-h</b> <i class="arg">host</i></span>] [<span class="opt"><b class="flag">-p</b> <i class="arg">prompt</i></span>] [<span class="opt"><b class="flag">-u</b> <i class="arg">user</i></span>] <i class="arg">file ...</i></td>
</tr>
</tbody>
</table>
</div>
<div class="section">
<h1 id="x4445534352495054494f4e">DESCRIPTION</h1> <b class="name">sudo</b> allows a permitted user to execute a <i class="arg">command</i> as the superuser or another user, as specified by the security policy. The invoking user's real (<span class="emph">not</span> effective) user ID is used to determine the user name with which to query the security policy.<div class="spacer">
</div>
<b class="name">sudo</b> supports a plugin architecture for security policies and input/output logging. Third parties can develop and distribute their own policy and I/O logging plugins to work seamlessly with the <b class="name">sudo</b> front end. The default security policy is <span class="emph">sudoers</span>, which is configured via the file <i class="file">/etc/sudoers</i>, or via LDAP. See the <i class="link-sec"><a class="link-sec" href="#x506c7567696e73">Plugins</a></i> section for more information.<div class="spacer">
</div>
The security policy determines what privileges, if any, a user has to run <b class="name">sudo</b>. The policy may require that users authenticate themselves with a password or another authentication mechanism. If authentication is required, <b class="name">sudo</b> will exit if the user's password is not entered within a configurable time limit. This limit is policy-specific; the default password prompt timeout for the <span class="emph">sudoers</span> security policy is <code class="lit">5</code> minutes.<div class="spacer">
</div>
Security policies may support credential caching to allow the user to run <b class="name">sudo</b> again for a period of time without requiring authentication. The <span class="emph">sudoers</span> policy caches credentials for <code class="lit">5</code> minutes, unless overridden in <a class="link-man">sudoers(5)</a>. By running <b class="name">sudo</b> with the <b class="flag">-v</b> option, a user can update the cached credentials without running a <i class="arg">command</i>.<div class="spacer">
</div>
When invoked as <b class="name">sudoedit</b>, the <b class="flag">-e</b> option (described below), is implied.<div class="spacer">
</div>
Security policies may log successful and failed attempts to use <b class="name">sudo</b>. If an I/O plugin is configured, the running command's input and output may be logged as well.<div class="spacer">
</div>
The options are as follows:<dl style="margin-top: 0.00em;margin-bottom: 0.00em;" class="list list-tag">
<dt class="list-tag" style="margin-top: 1.00em;">
<b class="flag">-A</b>, <b class="flag">--askpass</b></dt>
<dd class="list-tag" style="margin-left: 10.00ex;">
Normally, if <b class="name">sudo</b> requires a password, it will read it from the user's terminal. If the <b class="flag">-A</b> (<span class="emph">askpass</span>) option is specified, a (possibly graphical) helper program is executed to read the user's password and output the password to the standard output. If the <span class="env">SUDO_ASKPASS</span> environment variable is set, it specifies the path to the helper program. Otherwise, if <a class="link-man">sudo.conf(5)</a> contains a line specifying the askpass program, that value will be used. For example:<div class="spacer">
</div>
<pre style="margin-left: 4.00ex;" class="lit display">
# Path to askpass helper program 
Path askpass /usr/X11R6/bin/ssh-askpass</pre>
<div class="spacer">
</div>
If no askpass program is available, <b class="name">sudo</b> will exit with an error.</dd>
<dt class="list-tag" style="margin-top: 1.00em;">
<b class="flag">-b</b>, <b class="flag">--background</b></dt>
<dd class="list-tag" style="margin-left: 10.00ex;">
Run the given command in the background. Note that it is not possible to use shell job control to manipulate background processes started by <b class="name">sudo</b>. Most interactive commands will fail to work properly in background mode.</dd>
<dt class="list-tag" style="margin-top: 1.00em;">
<b class="flag">-C</b> <i class="arg">num</i>, <b class="flag">--close-from</b>=<i class="arg">num</i></dt>
<dd class="list-tag" style="margin-left: 10.00ex;">
Close all file descriptors greater than or equal to <i class="arg">num</i> before executing a command. Values less than three are not permitted. By default, <b class="name">sudo</b> will close all open file descriptors other than standard input, standard output and standard error when executing a command. The security policy may restrict the user's ability to use this option. The <span class="emph">sudoers</span> policy only permits use of the <b class="flag">-C</b> option when the administrator has enabled the <span class="emph">closefrom_override</span> option.</dd>
<dt class="list-tag" style="margin-top: 1.00em;">
<b class="flag">-E</b>, <b class="flag">--preserve-env</b></dt>
<dd class="list-tag" style="margin-left: 10.00ex;">
Indicates to the security policy that the user wishes to preserve their existing environment variables. The security policy may return an error if the user does not have permission to preserve the environment.</dd>
<dt class="list-tag" style="margin-top: 1.00em;">
<b class="flag">-e</b>, <b class="flag">--edit</b></dt>
<dd class="list-tag" style="margin-left: 10.00ex;">
Edit one or more files instead of running a command. In lieu of a path name, the string &quot;sudoedit&quot; is used when consulting the security policy. If the user is authorized by the policy, the following steps are taken:<ol style="margin-top: 0.00em;margin-bottom: 0.00em;margin-left: 1.00ex;" class="list list-enum">
<li class="list-enum" style="margin-top: 1.00em;">
Temporary copies are made of the files to be edited with the owner set to the invoking user.</li>
<li class="list-enum" style="margin-top: 1.00em;">
The editor specified by the policy is run to edit the temporary files. The <span class="emph">sudoers</span> policy uses the <span class="env">SUDO_EDITOR</span>, <span class="env">VISUAL</span> and <span class="env">EDITOR</span> environment variables (in that order). If none of <span class="env">SUDO_EDITOR</span>, <span class="env">VISUAL</span> or <span class="env">EDITOR</span> are set, the first program listed in the <span class="emph">editor</span> <a class="link-man">sudoers(5)</a> option is used.</li>
<li class="list-enum" style="margin-top: 1.00em;">
If they have been modified, the temporary files are copied back to their original location and the temporary versions are removed.</li>
</ol>
<div class="spacer">
</div>
Unless explicitly allowed by the security policy, symbolic links will not be opened. This helps prevent the editing of unauthorized files when the file is located in a user-writable directory. Versions of <b class="name">sudo</b> prior to 1.8.15 do not have this restriction. Users are never allowed to edit device special files.<div class="spacer">
</div>
If the specified file does not exist, it will be created. Note that unlike most commands run by <span class="emph">sudo</span>, the editor is run with the invoking user's environment unmodified. If, for some reason, <b class="name">sudo</b> is unable to update a file with its edited version, the user will receive a warning and the edited copy will remain in a temporary file.</dd>
<dt class="list-tag" style="margin-top: 1.00em;">
<b class="flag">-g</b> <i class="arg">group</i>, <b class="flag">--group</b>=<i class="arg">group</i></dt>
<dd class="list-tag" style="margin-left: 10.00ex;">
Run the command with the primary group set to <i class="arg">group</i> instead of the primary group specified by the target user's password database entry. The <i class="arg">group</i> may be either a group name or a numeric group ID (GID) prefixed with the &#8216;<code class="lit">#</code>&#8217; character (e.g. <code class="lit">#0</code> for GID 0). When running a command as a GID, many shells require that the &#8216;<code class="lit">#</code>&#8217; be escaped with a backslash (&#8216;<code class="lit">\</code>&#8217;). If no <b class="flag">-u</b> option is specified, the command will be run as the invoking user. In either case, the primary group will be set to <i class="arg">group</i>.</dd>
<dt class="list-tag" style="margin-top: 1.00em;">
<b class="flag">-H</b>, <b class="flag">--set-home</b></dt>
<dd class="list-tag" style="margin-left: 10.00ex;">
Request that the security policy set the <span class="env">HOME</span> environment variable to the home directory specified by the target user's password database entry. Depending on the policy, this may be the default behavior.</dd>
<dt class="list-tag" style="margin-top: 1.00em;">
<b class="flag">-h</b>, <b class="flag">--help</b></dt>
<dd class="list-tag" style="margin-left: 10.00ex;">
Display a short help message to the standard output and exit.</dd>
<dt class="list-tag" style="margin-top: 1.00em;">
<b class="flag">-h</b> <i class="arg">host</i>, <b class="flag">--host</b>=<i class="arg">host</i></dt>
<dd class="list-tag" style="margin-left: 10.00ex;">
Run the command on the specified <i class="arg">host</i> if the security policy plugin supports remote commands. Note that the <span class="emph">sudoers</span> plugin does not currently support running remote commands. This may also be used in conjunction with the <b class="flag">-l</b> option to list a user's privileges for the remote host.</dd>
<dt class="list-tag" style="margin-top: 1.00em;">
<b class="flag">-i</b>, <b class="flag">--login</b></dt>
<dd class="list-tag" style="margin-left: 10.00ex;">
Run the shell specified by the target user's password database entry as a login shell. This means that login-specific resource files such as <i class="file">.profile</i> or <i class="file">.login</i> will be read by the shell. If a command is specified, it is passed to the shell for execution via the shell's <b class="flag">-c</b> option. If no command is specified, an interactive shell is executed. <b class="name">sudo</b> attempts to change to that user's home directory before running the shell. The command is run with an environment similar to the one a user would receive at log in. The <span class="emph">Command environment</span> section in the <a class="link-man">sudoers(5)</a> manual documents how the <b class="flag">-i</b> option affects the environment in which a command is run when the <span class="emph">sudoers</span> policy is in use.</dd>
<dt class="list-tag" style="margin-top: 1.00em;">
<b class="flag">-K</b>, <b class="flag">--remove-timestamp</b></dt>
<dd class="list-tag" style="margin-left: 10.00ex;">
Similar to the <b class="flag">-k</b> option, except that it removes the user's cached credentials entirely and may not be used in conjunction with a command or other option. This option does not require a password. Not all security policies support credential caching.</dd>
<dt class="list-tag" style="margin-top: 1.00em;">
<b class="flag">-k</b>, <b class="flag">--reset-timestamp</b></dt>
<dd class="list-tag" style="margin-left: 10.00ex;">
When used without a command, invalidates the user's cached credentials. In other words, the next time <b class="name">sudo</b> is run a password will be required. This option does not require a password and was added to allow a user to revoke <b class="name">sudo</b> permissions from a <i class="file">.logout</i> file.<div class="spacer">
</div>
When used in conjunction with a command or an option that may require a password, this option will cause <b class="name">sudo</b> to ignore the user's cached credentials. As a result, <b class="name">sudo</b> will prompt for a password (if one is required by the security policy) and will not update the user's cached credentials.<div class="spacer">
</div>
Not all security policies support credential caching.</dd>
<dt class="list-tag" style="margin-top: 1.00em;">
<b class="flag">-l</b>, <b class="flag">--list</b></dt>
<dd class="list-tag" style="margin-left: 10.00ex;">
If no <i class="arg">command</i> is specified, list the allowed (and forbidden) commands for the invoking user (or the user specified by the <b class="flag">-U</b> option) on the current host. A longer list format is used if this option is specified multiple times and the security policy supports a verbose output format.<div class="spacer">
</div>
If a <i class="arg">command</i> is specified and is permitted by the security policy, the fully-qualified path to the command is displayed along with any command line arguments. If <i class="arg">command</i> is specified but not allowed, <b class="name">sudo</b> will exit with a status value of 1.</dd>
<dt class="list-tag" style="margin-top: 1.00em;">
<b class="flag">-n</b>, <b class="flag">--non-interactive</b></dt>
<dd class="list-tag" style="margin-left: 10.00ex;">
Avoid prompting the user for input of any kind. If a password is required for the command to run, <b class="name">sudo</b> will display an error message and exit.</dd>
<dt class="list-tag" style="margin-top: 1.00em;">
<b class="flag">-P</b>, <b class="flag">--preserve-groups</b></dt>
<dd class="list-tag" style="margin-left: 10.00ex;">
Preserve the invoking user's group vector unaltered. By default, the <span class="emph">sudoers</span> policy will initialize the group vector to the list of groups the target user is a member of. The real and effective group IDs, however, are still set to match the target user.</dd>
<dt class="list-tag" style="margin-top: 1.00em;">
<b class="flag">-p</b> <i class="arg">prompt</i>, <b class="flag">--prompt</b>=<i class="arg">prompt</i></dt>
<dd class="list-tag" style="margin-left: 10.00ex;">
Use a custom password prompt with optional escape sequences. The following percent (&#8216;<code class="lit">%</code>&#8217;) escape sequences are supported by the <span class="emph">sudoers</span> policy:<dl style="margin-top: 0.00em;margin-bottom: 0.00em;" class="list list-tag">
<dt class="list-tag" style="margin-top: 1.00em;">
<code class="lit">%H</code></dt>
<dd class="list-tag" style="margin-left: 2.00ex;">
expanded to the host name including the domain name (on if the machine's host name is fully qualified or the <span class="emph">fqdn</span> option is set in <a class="link-man">sudoers(5)</a>)</dd>
<dt class="list-tag" style="margin-top: 1.00em;">
<code class="lit">%h</code></dt>
<dd class="list-tag" style="margin-left: 2.00ex;">
expanded to the local host name without the domain name</dd>
<dt class="list-tag" style="margin-top: 1.00em;">
<code class="lit">%p</code></dt>
<dd class="list-tag" style="margin-left: 2.00ex;">
expanded to the name of the user whose password is being requested (respects the <span class="emph">rootpw</span>, <span class="emph">targetpw</span>, and <span class="emph">runaspw</span> flags in <a class="link-man">sudoers(5)</a>)</dd>
<dt class="list-tag" style="margin-top: 1.00em;">
<code class="lit">%U</code></dt>
<dd class="list-tag" style="margin-left: 2.00ex;">
expanded to the login name of the user the command will be run as (defaults to root unless the <b class="flag">-u</b> option is also specified)</dd>
<dt class="list-tag" style="margin-top: 1.00em;">
<code class="lit">%u</code></dt>
<dd class="list-tag" style="margin-left: 2.00ex;">
expanded to the invoking user's login name</dd>
<dt class="list-tag" style="margin-top: 1.00em;">
<code class="lit">%%</code></dt>
<dd class="list-tag" style="margin-left: 2.00ex;">
two consecutive &#8216;<code class="lit">%</code>&#8217; characters are collapsed into a single &#8216;<code class="lit">%</code>&#8217; character</dd>
</dl>
<div class="spacer">
</div>
The custom prompt will override the system password prompt on systems that support PAM unless the <span class="emph">passprompt_override</span> flag is disabled in <span class="emph">sudoers</span>.</dd>
<dt class="list-tag" style="margin-top: 1.00em;">
<b class="flag">-S</b>, <b class="flag">--stdin</b></dt>
<dd class="list-tag" style="margin-left: 10.00ex;">
Write the prompt to the standard error and read the password from the standard input instead of using the terminal device. The password must be followed by a newline character.</dd>
<dt class="list-tag" style="margin-top: 1.00em;">
<b class="flag">-s</b>, <b class="flag">--shell</b></dt>
<dd class="list-tag" style="margin-left: 10.00ex;">
Run the shell specified by the <span class="env">SHELL</span> environment variable if it is set or the shell specified by the invoking user's password database entry. If a command is specified, it is passed to the shell for execution via the shell's <b class="flag">-c</b> option. If no command is specified, an interactive shell is executed.</dd>
<dt class="list-tag" style="margin-top: 1.00em;">
<b class="flag">-U</b> <i class="arg">user</i>, <b class="flag">--other-user</b>=<i class="arg">user</i></dt>
<dd class="list-tag" style="margin-left: 10.00ex;">
Used in conjunction with the <b class="flag">-l</b> option to list the privileges for <i class="arg">user</i> instead of for the invoking user. The security policy may restrict listing other users' privileges. The <span class="emph">sudoers</span> policy only allows root or a user with the <code class="lit">ALL</code> privilege on the current host to use this option.</dd>
<dt class="list-tag" style="margin-top: 1.00em;">
<b class="flag">-u</b> <i class="arg">user</i>, <b class="flag">--user</b>=<i class="arg">user</i></dt>
<dd class="list-tag" style="margin-left: 10.00ex;">
Run the command as a user other than the default target user (usually <span class="emph">root</span>). The <i class="arg">user</i> may be either a user name or a numeric user ID (UID) prefixed with the &#8216;<code class="lit">#</code>&#8217; character (e.g. <code class="lit">#0</code> for UID 0). When running commands as a UID, many shells require that the &#8216;<code class="lit">#</code>&#8217; be escaped with a backslash (&#8216;<code class="lit">\</code>&#8217;). Some security policies may restrict UIDs to those listed in the password database. The <span class="emph">sudoers</span> policy allows UIDs that are not in the password database as long as the <span class="emph">targetpw</span> option is not set. Other security policies may not support this.</dd>
<dt class="list-tag" style="margin-top: 1.00em;">
<b class="flag">-V</b>, <b class="flag">--version</b></dt>
<dd class="list-tag" style="margin-left: 10.00ex;">
Print the <b class="name">sudo</b> version string as well as the version string of the security policy plugin and any I/O plugins. If the invoking user is already root the <b class="flag">-V</b> option will display the arguments passed to configure when <b class="name">sudo</b> was built and plugins may display more verbose information such as default options.</dd>
<dt class="list-tag" style="margin-top: 1.00em;">
<b class="flag">-v</b>, <b class="flag">--validate</b></dt>
<dd class="list-tag" style="margin-left: 10.00ex;">
Update the user's cached credentials, authenticating the user if necessary. For the <span class="emph">sudoers</span> plugin, this extends the <b class="name">sudo</b> timeout for another <code class="lit">5</code> minutes by default, but does not run a command. Not all security policies support cached credentials.</dd>
<dt class="list-tag" style="margin-top: 1.00em;">
<b class="flag">--</b></dt>
<dd class="list-tag" style="margin-left: 10.00ex;">
The <b class="flag">--</b> option indicates that <b class="name">sudo</b> should stop processing command line arguments.</dd>
</dl>
<div class="spacer">
</div>
Environment variables to be set for the command may also be passed on the command line in the form of <i class="arg">VAR</i>=<i class="arg">value</i>, e.g. <span class="env">LD_LIBRARY_PATH</span>=<i class="file">/usr/local/pkg/lib</i>. Variables passed on the command line are subject to restrictions imposed by the security policy plugin. The <span class="emph">sudoers</span> policy subjects variables passed on the command line to the same restrictions as normal environment variables with one important exception. If the <span class="emph">setenv</span> option is set in <span class="emph">sudoers</span>, the command to be run has the <code class="lit">SETENV</code> tag set or the command matched is <code class="lit">ALL</code>, the user may set variables that would otherwise be forbidden. See <a class="link-man">sudoers(5)</a> for more information.</div>
<div class="section">
<h1 id="x434f4d4d414e4420455845435554494f4e">COMMAND EXECUTION</h1> When <b class="name">sudo</b> executes a command, the security policy specifies the execution environment for the command. Typically, the real and effective user and group and IDs are set to match those of the target user, as specified in the password database, and the group vector is initialized based on the group database (unless the <b class="flag">-P</b> option was specified).<div class="spacer">
</div>
The following parameters may be specified by security policy:<ul style="margin-top: 0.00em;margin-bottom: 0.00em;" class="list list-bul">
<li class="list-bul" style="margin-top: 1.00em;">
real and effective user ID</li>
<li class="list-bul" style="margin-top: 1.00em;">
real and effective group ID</li>
<li class="list-bul" style="margin-top: 1.00em;">
supplementary group IDs</li>
<li class="list-bul" style="margin-top: 1.00em;">
the environment list</li>
<li class="list-bul" style="margin-top: 1.00em;">
current working directory</li>
<li class="list-bul" style="margin-top: 1.00em;">
file creation mode mask (umask)</li>
<li class="list-bul" style="margin-top: 1.00em;">
scheduling priority (aka nice value)</li>
</ul>
<div class="subsection">
<h2 id="x50726f63657373206d6f64656c">Process model</h2> When <b class="name">sudo</b> runs a command, it calls <a class="link-man">fork(2)</a>, sets up the execution environment as described above, and calls the <a class="link-man">execve</a> system call in the child process. The main <b class="name">sudo</b> process waits until the command has completed, then passes the command's exit status to the security policy's close function and exits. If an I/O logging plugin is configured or if the security policy explicitly requests it, a new  pseudo-terminal (&#8220;pty&#8221;) is created and a second <b class="name">sudo</b> process is used to relay job control signals between the user's existing pty and the new pty the command is being run in. This extra process makes it possible to, for example, suspend and resume the command. Without it, the command would be in what POSIX terms an &#8220;orphaned process group&#8221; and it would not receive any job control signals. As a special case, if the policy plugin does not define a close function and no pty is required, <b class="name">sudo</b> will execute the command directly instead of calling <a class="link-man">fork(2)</a> first. The <span class="emph">sudoers</span> policy plugin will only define a close function when I/O logging is enabled, a pty is required, or the <span class="emph">pam_session</span> or <span class="emph">pam_setcred</span> options are enabled. Note that <span class="emph">pam_session</span> and <span class="emph">pam_setcred</span> are enabled by default on systems using PAM.</div>
<div class="subsection">
<h2 id="x5369676e616c2068616e646c696e67">Signal handling</h2> When the command is run as a child of the <b class="name">sudo</b> process, <b class="name">sudo</b> will relay signals it receives to the command. Unless the command is being run in a new pty, the <span class="define">SIGINT</span> and <span class="define">SIGQUIT</span> signals are not relayed unless they are sent by a user process, not the kernel. Otherwise, the command would receive <span class="define">SIGINT</span> twice every time the user entered control-C. Some signals, such as <span class="define">SIGSTOP</span> and <span class="define">SIGKILL</span>, cannot be caught and thus will not be relayed to the command. As a general rule, <span class="define">SIGTSTP</span> should be used instead of <span class="define">SIGSTOP</span> when you wish to suspend a command being run by <b class="name">sudo</b>.<div class="spacer">
</div>
As a special case, <b class="name">sudo</b> will not relay signals that were sent by the command it is running. This prevents the command from accidentally killing itself. On some systems, the <a class="link-man">reboot(8)</a> command sends <span class="define">SIGTERM</span> to all non-system processes other than itself before rebooting the system. This prevents <b class="name">sudo</b> from relaying the <span class="define">SIGTERM</span> signal it received back to <a class="link-man">reboot(8)</a>, which might then exit before the system was actually rebooted, leaving it in a half-dead state similar to single user mode. Note, however, that this check only applies to the command run by <b class="name">sudo</b> and not any other processes that the command may create. As a result, running a script that calls <a class="link-man">reboot(8)</a> or <a class="link-man">shutdown(8)</a> via <b class="name">sudo</b> may cause the system to end up in this undefined state unless the <a class="link-man">reboot(8)</a> or <a class="link-man">shutdown(8)</a> are run using the <b class="fname">exec</b>() family of functions instead of <b class="fname">system</b>() (which interposes a shell between the command and the calling process).<div class="spacer">
</div>
If no I/O logging plugins are loaded and the policy plugin has not defined a <b class="fname">close</b>() function, set a command timeout or required that the command be run in a new pty, <b class="name">sudo</b> may execute the command directly instead of running it as a child process.</div>
<div class="subsection">
<h2 id="x506c7567696e73">Plugins</h2> Plugins may be specified via <code class="lit">Plugin</code> directives in the <a class="link-man">sudo.conf(5)</a> file. They may be loaded as dynamic shared objects (on systems that support them), or compiled directly into the <b class="name">sudo</b> binary. If no <a class="link-man">sudo.conf(5)</a> file is present, or it contains no <code class="lit">Plugin</code> lines, <b class="name">sudo</b> will use the traditional <span class="emph">sudoers</span> security policy and I/O logging. See the <a class="link-man">sudo.conf(5)</a> manual for details of the <i class="file">/etc/sudo.conf</i> file and the <a class="link-man">sudo_plugin(8)</a> manual for more information about the <b class="name">sudo</b> plugin architecture.</div>
</div>
<div class="section">
<h1 id="x455849542056414c5545">EXIT VALUE</h1> Upon successful execution of a command, the exit status from <b class="name">sudo</b> will be the exit status of the program that was executed. If the command terminated due to receipt of a signal, <b class="name">sudo</b> will send itself the signal that terminated the command.<div class="spacer">
</div>
Otherwise, <b class="name">sudo</b> exits with a value of 1 if there is a configuration/permission problem or if <b class="name">sudo</b> cannot execute the given command. In the latter case, the error string is printed to the standard error. If <b class="name">sudo</b> cannot <a class="link-man">stat(2)</a> one or more entries in the user's <span class="env">PATH</span>, an error is printed to the standard error. (If the directory does not exist or if it is not really a directory, the entry is ignored and no error is printed.) This should not happen under normal circumstances. The most common reason for <a class="link-man">stat(2)</a> to return &#8220;permission denied&#8221; is if you are running an automounter and one of the directories in your <span class="env">PATH</span> is on a machine that is currently unreachable.</div>
<div class="section">
<h1 id="x5345435552495459204e4f544553">SECURITY NOTES</h1> <b class="name">sudo</b> tries to be safe when executing external commands.<div class="spacer">
</div>
To prevent command spoofing, <b class="name">sudo</b> checks &quot;.&quot; and &quot;&quot; (both denoting current directory) last when searching for a command in the user's <span class="env">PATH</span> (if one or both are in the <span class="env">PATH</span>). Note, however, that the actual <span class="env">PATH</span> environment variable is <span class="emph">not</span> modified and is passed unchanged to the program that <b class="name">sudo</b> executes.<div class="spacer">
</div>
Users should <span class="emph">never</span> be granted <b class="name">sudo</b> privileges to execute files that are writable by the user or that reside in a directory that is writable by the user. If the user can modify or replace the command there is no way to limit what additional commands they can run. Likewise, users should <span class="emph">never</span> be granted <b class="name">sudoedit</b> permission to edit a file that resides in a directory the user has write access to. A user with directory write access could replace the legitimate file with a link to some other, arbitrary, file. Starting with version 1.8.15, <b class="name">sudoedit</b> will refuse to open a symbolic link unless the security policy explicitly permits it. However, it is still possible to create a hard link if the directory is writable and the link target resides on the same file system.<div class="spacer">
</div>
Please note that <b class="name">sudo</b> will normally only log the command it explicitly runs. If a user runs a command such as <code class="lit">sudo su</code> or <code class="lit">sudo sh</code>, subsequent commands run from that shell are not subject to <b class="name">sudo</b>'s security policy. The same is true for commands that offer shell escapes (including most editors). If I/O logging is enabled, subsequent commands will have their input and/or output logged, but there will not be traditional logs for those commands. Because of this, care must be taken when giving users access to commands via <b class="name">sudo</b> to verify that the command does not inadvertently give the user an effective root shell. For more information, please see the <span class="emph">Preventing shell escapes</span> section in <a class="link-man">sudoers(5)</a>.<div class="spacer">
</div>
To prevent the disclosure of potentially sensitive information, <b class="name">sudo</b> disables core dumps by default while it is executing (they are re-enabled for the command that is run). This historical practice dates from a time when most operating systems allowed setuid processes to dump core by default. To aid in debugging <b class="name">sudo</b> crashes, you may wish to re-enable core dumps by setting &#8220;disable_coredump&#8221; to false in the <a class="link-man">sudo.conf(5)</a> file as follows:<div class="spacer">
</div>
<pre style="margin-left: 5.00ex;" class="lit display">
Set disable_coredump false</pre>
<div class="spacer">
</div>
See the <a class="link-man">sudo.conf(5)</a> manual for more information.</div>
<div class="section">
<h1 id="x454e5649524f4e4d454e54">ENVIRONMENT</h1> <b class="name">sudo</b> utilizes the following environment variables. The security policy has control over the actual content of the command's environment.<dl style="margin-top: 0.00em;margin-bottom: 0.00em;" class="list list-tag">
<dt class="list-tag" style="margin-top: 1.00em;">
<span class="env">EDITOR</span></dt>
<dd class="list-tag" style="margin-left: 15.00ex;">
Default editor to use in <b class="flag">-e</b> (sudoedit) mode if neither <span class="env">SUDO_EDITOR</span> nor <span class="env">VISUAL</span> is set.</dd>
<dt class="list-tag" style="margin-top: 1.00em;">
<span class="env">MAIL</span></dt>
<dd class="list-tag" style="margin-left: 15.00ex;">
Set to the mail spool of the target user when the <b class="flag">-i</b> option is specified or when <span class="emph">env_reset</span> is enabled in <span class="emph">sudoers</span> (unless <span class="env">MAIL</span> is present in the <span class="emph">env_keep</span> list).</dd>
<dt class="list-tag" style="margin-top: 1.00em;">
<span class="env">HOME</span></dt>
<dd class="list-tag" style="margin-left: 15.00ex;">
Set to the home directory of the target user when the <b class="flag">-i</b> or <b class="flag">-H</b> options are specified, when the <b class="flag">-s</b> option is specified and <span class="emph">set_home</span> is set in <span class="emph">sudoers</span>, when <span class="emph">always_set_home</span> is enabled in <span class="emph">sudoers</span>, or when <span class="emph">env_reset</span> is enabled in <span class="emph">sudoers</span> and <span class="emph">HOME</span> is not present in the <span class="emph">env_keep</span> list.</dd>
<dt class="list-tag" style="margin-top: 1.00em;">
<span class="env">LOGNAME</span></dt>
<dd class="list-tag" style="margin-left: 15.00ex;">
Set to the login name of the target user when the <b class="flag">-i</b> option is specified, when the <span class="emph">set_logname</span> option is enabled in <span class="emph">sudoers</span> or when the <span class="emph">env_reset</span> option is enabled in <span class="emph">sudoers</span> (unless <span class="env">LOGNAME</span> is present in the <span class="emph">env_keep</span> list).</dd>
<dt class="list-tag" style="margin-top: 1.00em;">
<span class="env">PATH</span></dt>
<dd class="list-tag" style="margin-left: 15.00ex;">
May be overridden by the security policy.</dd>
<dt class="list-tag" style="margin-top: 1.00em;">
<span class="env">SHELL</span></dt>
<dd class="list-tag" style="margin-left: 15.00ex;">
Used to determine shell to run with <b class="flag">-s</b> option.</dd>
<dt class="list-tag" style="margin-top: 1.00em;">
<span class="env">SUDO_ASKPASS</span></dt>
<dd class="list-tag" style="margin-left: 15.00ex;">
Specifies the path to a helper program used to read the password if no terminal is available or if the <b class="flag">-A</b> option is specified.</dd>
<dt class="list-tag" style="margin-top: 1.00em;">
<span class="env">SUDO_COMMAND</span></dt>
<dd class="list-tag" style="margin-left: 15.00ex;">
Set to the command run by sudo.</dd>
<dt class="list-tag" style="margin-top: 1.00em;">
<span class="env">SUDO_EDITOR</span></dt>
<dd class="list-tag" style="margin-left: 15.00ex;">
Default editor to use in <b class="flag">-e</b> (sudoedit) mode.</dd>
<dt class="list-tag" style="margin-top: 1.00em;">
<span class="env">SUDO_GID</span></dt>
<dd class="list-tag" style="margin-left: 15.00ex;">
Set to the group ID of the user who invoked sudo.</dd>
<dt class="list-tag" style="margin-top: 1.00em;">
<span class="env">SUDO_PROMPT</span></dt>
<dd class="list-tag" style="margin-left: 15.00ex;">
Used as the default password prompt.</dd>
<dt class="list-tag" style="margin-top: 1.00em;">
<span class="env">SUDO_PS1</span></dt>
<dd class="list-tag" style="margin-left: 15.00ex;">
If set, <span class="env">PS1</span> will be set to its value for the program being run.</dd>
<dt class="list-tag" style="margin-top: 1.00em;">
<span class="env">SUDO_UID</span></dt>
<dd class="list-tag" style="margin-left: 15.00ex;">
Set to the user ID of the user who invoked sudo.</dd>
<dt class="list-tag" style="margin-top: 1.00em;">
<span class="env">SUDO_USER</span></dt>
<dd class="list-tag" style="margin-left: 15.00ex;">
Set to the login name of the user who invoked sudo.</dd>
<dt class="list-tag" style="margin-top: 1.00em;">
<span class="env">USER</span></dt>
<dd class="list-tag" style="margin-left: 15.00ex;">
Set to the same value as <span class="env">LOGNAME</span>, described above.</dd>
<dt class="list-tag" style="margin-top: 1.00em;">
<span class="env">USERNAME</span></dt>
<dd class="list-tag" style="margin-left: 15.00ex;">
Same as <span class="env">USER</span>.</dd>
<dt class="list-tag" style="margin-top: 1.00em;">
<span class="env">VISUAL</span></dt>
<dd class="list-tag" style="margin-left: 15.00ex;">
Default editor to use in <b class="flag">-e</b> (sudoedit) mode if <span class="env">SUDO_EDITOR</span> is not set.</dd>
</dl>
</div>
<div class="section">
<h1 id="x46494c4553">FILES</h1><dl style="margin-top: 0.00em;margin-bottom: 0.00em;" class="list list-tag">
<dt class="list-tag" style="margin-top: 1.00em;">
<i class="file">/etc/sudo.conf</i></dt>
<dd class="list-tag" style="margin-left: 24.00ex;">
<b class="name">sudo</b> front end configuration</dd>
</dl>
</div>
<div class="section">
<h1 id="x4558414d504c4553">EXAMPLES</h1> Note: the following examples assume a properly configured security policy.<div class="spacer">
</div>
To get a file listing of an unreadable directory:<div class="spacer">
</div>
<pre style="margin-left: 5.00ex;" class="lit display">
$ sudo ls /usr/local/protected</pre>
<div class="spacer">
</div>
To list the home directory of user yaz on a machine where the file system holding ~yaz is not exported as root:<div class="spacer">
</div>
<pre style="margin-left: 5.00ex;" class="lit display">
$ sudo -u yaz ls ~yaz</pre>
<div class="spacer">
</div>
To edit the <i class="file">index.html</i> file as user www:<div class="spacer">
</div>
<pre style="margin-left: 5.00ex;" class="lit display">
$ sudo -u www vi ~www/htdocs/index.html</pre>
<div class="spacer">
</div>
To view system logs only accessible to root and users in the adm group:<div class="spacer">
</div>
<pre style="margin-left: 5.00ex;" class="lit display">
$ sudo -g adm view /var/log/syslog</pre>
<div class="spacer">
</div>
To run an editor as jim with a different primary group:<div class="spacer">
</div>
<pre style="margin-left: 5.00ex;" class="lit display">
$ sudo -u jim -g audio vi ~jim/sound.txt</pre>
<div class="spacer">
</div>
To shut down a machine:<div class="spacer">
</div>
<pre style="margin-left: 5.00ex;" class="lit display">
$ sudo shutdown -r +15 &quot;quick reboot&quot;</pre>
<div class="spacer">
</div>
To make a usage listing of the directories in the /home partition. Note that this runs the commands in a sub-shell to make the <code class="lit">cd</code> and file redirection work.<div class="spacer">
</div>
<pre style="margin-left: 5.00ex;" class="lit display">
$ sudo sh -c &quot;cd /home ; du -s * | sort -rn &gt; USAGE&quot;</pre>
</div>
<div class="section">
<h1 id="x53454520414c534f">SEE ALSO</h1> <a class="link-man">su(1)</a>, <a class="link-man">stat(2)</a>, <a class="link-man">passwd(5)</a>, <a class="link-man">sudo.conf(5)</a>, <a class="link-man">sudoers(5)</a>, <a class="link-man">sudo_plugin(8)</a>, <a class="link-man">sudoreplay(8)</a>, <a class="link-man">visudo(8)</a></div>
<div class="section">
<h1 id="x484953544f5259">HISTORY</h1> See the HISTORY file in the <b class="name">sudo</b> distribution (http://www.sudo.ws/history.html) for a brief history of sudo.</div>
<div class="section">
<h1 id="x415554484f5253">AUTHORS</h1> Many people have worked on <b class="name">sudo</b> over the years; this version consists of code written primarily by:<div class="spacer">
</div>
<div style="margin-left: 5.00ex;" class="display">
<span class="author">Todd C. Miller</span></div>
<div class="spacer">
</div>
See the CONTRIBUTORS file in the <b class="name">sudo</b> distribution (http://www.sudo.ws/contributors.html) for an exhaustive list of people who have contributed to <b class="name">sudo</b>.</div>
<div class="section">
<h1 id="x43415645415453">CAVEATS</h1> There is no easy way to prevent a user from gaining a root shell if that user is allowed to run arbitrary commands via <b class="name">sudo</b>. Also, many programs (such as editors) allow the user to run commands via shell escapes, thus avoiding <b class="name">sudo</b>'s checks. However, on most systems it is possible to prevent shell escapes with the <a class="link-man">sudoers(5)</a> plugin's <span class="emph">noexec</span> functionality.<div class="spacer">
</div>
It is not meaningful to run the <code class="lit">cd</code> command directly via sudo, e.g.,<div class="spacer">
</div>
<pre style="margin-left: 5.00ex;" class="lit display">
$ sudo cd /usr/local/protected</pre>
<div class="spacer">
</div>
since when the command exits the parent process (your shell) will still be the same. Please see the <i class="link-sec"><a class="link-sec" href="#x4558414d504c4553">EXAMPLES</a></i> section for more information.<div class="spacer">
</div>
Running shell scripts via <b class="name">sudo</b> can expose the same kernel bugs that make setuid shell scripts unsafe on some operating systems (if your OS has a /dev/fd/ directory, setuid shell scripts are generally safe).</div>
<div class="section">
<h1 id="x42554753">BUGS</h1> If you feel you have found a bug in <b class="name">sudo</b>, please submit a bug report at http://bugzilla.sudo.ws/</div>
<div class="section">
<h1 id="x535550504f5254">SUPPORT</h1> Limited free support is available via the sudo-users mailing list, see http://www.sudo.ws/mailman/listinfo/sudo-users to subscribe or search the archives.</div>
<div class="section">
<h1 id="x444953434c41494d4552">DISCLAIMER</h1> <b class="name">sudo</b> is provided &#8220;AS IS&#8221; and any express or implied warranties, including, but not limited to, the implied warranties of merchantability and fitness for a particular purpose are disclaimed. See the LICENSE file distributed with <b class="name">sudo</b> or http://www.sudo.ws/license.html for complete details.</div>
</div>
</body>
</html>

