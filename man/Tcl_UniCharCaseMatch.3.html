<!DOCTYPE html>
<html>
<head>
<meta charset="utf-8"/>
<style>
table.head, table.foot { width: 100%; }
td.head-rtitle, td.foot-os { text-align: right; }
td.head-vol { text-align: center; }
table.foot td { width: 50%; }
table.head td { width: 33%; }
div.spacer { margin: 1em 0; }
</style>
<title>
Utf(3)</title>
</head>
<body>
<div class="mandoc">
<table class="head">
<tbody>
<tr>
<td class="head-ltitle">
Utf(3)</td>
<td class="head-vol">
Tcl Library Procedures</td>
<td class="head-rtitle">
Utf(3)</td>
</tr>
</tbody>
</table>
<br/>
<br/>
<div class="section">
<h1>NAME</h1> Tcl_UniChar, Tcl_UniCharCaseMatch, Tcl_UniCharNcasecmp, Tcl_UniCharToUtf, Tcl_UtfToUniChar, Tcl_UniCharToUtfDString, Tcl_UtfToUniCharDString, Tcl_UniCharLen, Tcl_UniCharNcmp, Tcl_UtfCharComplete, Tcl_NumUtfChars, Tcl_UtfFindFirst, Tcl_UtfFindLast, Tcl_UtfNext, Tcl_UtfPrev, Tcl_UniCharAtIndex, Tcl_UtfAtIndex, Tcl_UtfBackslash - routines for manipulating UTF-8 strings</div>
<div class="section">
<h1>SYNOPSIS</h1><br/>
<b>#include &lt;tcl.h&gt;</b><div style="height: 1.00em;">
&#160;</div>
<br/>
typedef ... Tcl_UniChar;<div style="height: 1.00em;">
&#160;</div>
<br/>
int<br/>
<b>Tcl_UniCharToUtf</b>(<i>ch, buf</i>)<div style="height: 1.00em;">
&#160;</div>
<br/>
int<br/>
<b>Tcl_UtfToUniChar</b>(<i>src, chPtr</i>)<div style="height: 1.00em;">
&#160;</div>
<br/>
char *<br/>
<b>Tcl_UniCharToUtfDString</b>(<i>uniStr, uniLength, dsPtr</i>)<div style="height: 1.00em;">
&#160;</div>
<br/>
Tcl_UniChar *<br/>
<b>Tcl_UtfToUniCharDString</b>(<i>src, length, dsPtr</i>)<div style="height: 1.00em;">
&#160;</div>
<br/>
int<br/>
<b>Tcl_UniCharLen</b>(<i>uniStr</i>)<div style="height: 1.00em;">
&#160;</div>
<br/>
int<br/>
<b>Tcl_UniCharNcmp</b>(<i>ucs, uct, numChars</i>)<div style="height: 1.00em;">
&#160;</div>
<br/>
int<br/>
<b>Tcl_UniCharNcasecmp</b>(<i>ucs, uct, numChars</i>)<div style="height: 1.00em;">
&#160;</div>
<br/>
int<br/>
<b>Tcl_UniCharCaseMatch</b>(<i>uniStr, uniPattern, nocase</i>)<div style="height: 1.00em;">
&#160;</div>
<br/>
int<br/>
<b>Tcl_UtfNcmp</b>(<i>cs, ct, numChars</i>)<div style="height: 1.00em;">
&#160;</div>
<br/>
int<br/>
<b>Tcl_UtfNcasecmp</b>(<i>cs, ct, numChars</i>)<div style="height: 1.00em;">
&#160;</div>
<br/>
int<br/>
<b>Tcl_UtfCharComplete</b>(<i>src, length</i>)<div style="height: 1.00em;">
&#160;</div>
<br/>
int <br/>
<b>Tcl_NumUtfChars</b>(<i>src, length</i>)<div style="height: 1.00em;">
&#160;</div>
<br/>
const char *<br/>
<b>Tcl_UtfFindFirst</b>(<i>src, ch</i>)<div style="height: 1.00em;">
&#160;</div>
<br/>
const char *<br/>
<b>Tcl_UtfFindLast</b>(<i>src, ch</i>)<div style="height: 1.00em;">
&#160;</div>
<br/>
const char *<br/>
<b>Tcl_UtfNext</b>(<i>src</i>)<div style="height: 1.00em;">
&#160;</div>
<br/>
const char *<br/>
<b>Tcl_UtfPrev</b>(<i>src, start</i>)<div style="height: 1.00em;">
&#160;</div>
<br/>
Tcl_UniChar<br/>
<b>Tcl_UniCharAtIndex</b>(<i>src, index</i>)<div style="height: 1.00em;">
&#160;</div>
<br/>
const char *<br/>
<b>Tcl_UtfAtIndex</b>(<i>src, index</i>)<div style="height: 1.00em;">
&#160;</div>
<br/>
int<br/>
<b>Tcl_UtfBackslash</b>(<i>src, readPtr, dst</i>)</div>
<div class="section">
<h1>ARGUMENTS</h1><dl>
<dt>
char <i>*buf</i> (out)</dt>
<dd>
Buffer in which the UTF-8 representation of the Tcl_UniChar is stored.  At most  <b>TCL_UTF_MAX</b> bytes are stored in the buffer.</dd>
</dl>
<dl>
<dt>
int <i>ch</i> (in)</dt>
<dd>
The Tcl_UniChar to be converted or examined.</dd>
</dl>
<dl>
<dt>
Tcl_UniChar <i>*chPtr</i> (out)</dt>
<dd>
Filled with the Tcl_UniChar represented by the head of the UTF-8 string.</dd>
</dl>
<dl>
<dt>
const char <i>*src</i> (in)</dt>
<dd>
Pointer to a UTF-8 string.</dd>
</dl>
<dl>
<dt>
const char <i>*cs</i> (in)</dt>
<dd>
Pointer to a UTF-8 string.</dd>
</dl>
<dl>
<dt>
const char <i>*ct</i> (in)</dt>
<dd>
Pointer to a UTF-8 string.</dd>
</dl>
<dl>
<dt>
const Tcl_UniChar <i>*uniStr</i> (in)</dt>
<dd>
A null-terminated Unicode string.</dd>
</dl>
<dl>
<dt>
const Tcl_UniChar <i>*ucs</i> (in)</dt>
<dd>
A null-terminated Unicode string.</dd>
</dl>
<dl>
<dt>
const Tcl_UniChar <i>*uct</i> (in)</dt>
<dd>
A null-terminated Unicode string.</dd>
</dl>
<dl>
<dt>
const Tcl_UniChar <i>*uniPattern</i> (in)</dt>
<dd>
A null-terminated Unicode string.</dd>
</dl>
<dl>
<dt>
int <i>length</i> (in)</dt>
<dd>
The length of the UTF-8 string in bytes (not UTF-8 characters).  If negative, all bytes up to the first null byte are used.</dd>
</dl>
<dl>
<dt>
int <i>uniLength</i> (in)</dt>
<dd>
The length of the Unicode string in characters.  Must be greater than or equal to 0.</dd>
</dl>
<dl>
<dt>
Tcl_DString <i>*dsPtr</i> (in/out)</dt>
<dd>
A pointer to a previously initialized <b>Tcl_DString</b>.</dd>
</dl>
<dl>
<dt>
unsigned long <i>numChars</i> (in)</dt>
<dd>
The number of characters to compare.</dd>
</dl>
<dl>
<dt>
const char <i>*start</i> (in)</dt>
<dd>
Pointer to the beginning of a UTF-8 string.</dd>
</dl>
<dl>
<dt>
int <i>index</i> (in)</dt>
<dd>
The index of a character (not byte) in the UTF-8 string.</dd>
</dl>
<dl>
<dt>
int <i>*readPtr</i> (out)</dt>
<dd>
If non-NULL, filled with the number of bytes in the backslash sequence, including the backslash character.</dd>
</dl>
<dl>
<dt>
char <i>*dst</i> (out)</dt>
<dd>
Buffer in which the bytes represented by the backslash sequence are stored. At most  <b>TCL_UTF_MAX</b> bytes are stored in the buffer.</dd>
</dl>
<dl>
<dt>
int <i>nocase</i> (in)</dt>
<dd>
Specifies whether the match should be done case-sensitive (0) or case-insensitive (1).<br/>
<br/>
<div style="height: 0.00em;">
&#160;</div>
<div style="height: 1.00em;">
&#160;</div>
</dd>
</dl>
</div>
<div class="section">
<h1>DESCRIPTION</h1> These routines convert between UTF-8 strings and Tcl_UniChars.  A Tcl_UniChar is a Unicode character represented as an unsigned, fixed-size quantity.  A UTF-8 character is a Unicode character represented as a varying-length sequence of up to  <b>TCL_UTF_MAX</b> bytes.  A multibyte UTF-8 sequence consists of a lead byte followed by some number of trail bytes.<div class="spacer">
</div>
<b>TCL_UTF_MAX</b> is the maximum number of bytes that it takes to represent one Unicode character in the UTF-8 representation.<div class="spacer">
</div>
<b>Tcl_UniCharToUtf</b> stores the Tcl_UniChar <i>ch</i> as a UTF-8 string in starting at  <i>buf</i>.  The return value is the number of bytes stored in  <i>buf</i>.<div class="spacer">
</div>
<b>Tcl_UtfToUniChar</b> reads one UTF-8 character starting at <i>src</i> and stores it as a Tcl_UniChar in  <i>*chPtr</i>.  The return value is the number of bytes read from  <i>src</i>.  The caller must ensure that the source buffer is long enough such that this routine does not run off the end and dereference non-existent or random memory; if the source buffer is known to be null-terminated, this will not happen.  If the input is not in proper UTF-8 format,  <b>Tcl_UtfToUniChar</b> will store the first byte of  <i>src</i> in <i>*chPtr</i> as a Tcl_UniChar between 0x0000 and 0x00ff and return 1.<div class="spacer">
</div>
<b>Tcl_UniCharToUtfDString</b> converts the given Unicode string to UTF-8, storing the result in a previously initialized  <b>Tcl_DString</b>. You must specify  <i>uniLength</i>, the length of the given Unicode string. The return value is a pointer to the UTF-8 representation of the Unicode string.  Storage for the return value is appended to the end of the  <b>Tcl_DString</b>.<div class="spacer">
</div>
<b>Tcl_UtfToUniCharDString</b> converts the given UTF-8 string to Unicode, storing the result in the previously initialized  <b>Tcl_DString</b>. In the argument  <i>length</i>, you may either specify the length of the given UTF-8 string in bytes or &#8220;-1&#8221;, in which case  <b>Tcl_UtfToUniCharDString</b> uses <b>strlen</b> to calculate the length.  The return value is a pointer to the Unicode representation of the UTF-8 string.  Storage for the return value is appended to the end of the  <b>Tcl_DString</b>.  The Unicode string is terminated with a Unicode null character.<div class="spacer">
</div>
<b>Tcl_UniCharLen</b> corresponds to <b>strlen</b> for Unicode characters.  It accepts a null-terminated Unicode string and returns the number of Unicode characters (not bytes) in that string.<div class="spacer">
</div>
<b>Tcl_UniCharNcmp</b> and <b>Tcl_UniCharNcasecmp</b> correspond to  <b>strncmp</b> and <b>strncasecmp</b>, respectively, for Unicode characters. They accept two null-terminated Unicode strings and the number of characters to compare.  Both strings are assumed to be at least  <i>numChars</i> characters long.  <b>Tcl_UniCharNcmp</b>  compares the two strings character-by-character according to the Unicode character ordering.  It returns an integer greater than, equal to, or less than 0 if the first string is greater than, equal to, or less than the second string respectively.   <b>Tcl_UniCharNcasecmp</b> is the Unicode case insensitive version.<div class="spacer">
</div>
<b>Tcl_UniCharCaseMatch</b> is the Unicode equivalent to  <b>Tcl_StringCaseMatch</b>.  It accepts a null-terminated Unicode string, a Unicode pattern, and a boolean value specifying whether the match should be case sensitive and returns whether the string matches the pattern.<div class="spacer">
</div>
<b>Tcl_UtfNcmp</b> corresponds to <b>strncmp</b> for UTF-8 strings. It accepts two null-terminated UTF-8 strings and the number of characters to compare.  (Both strings are assumed to be at least  <i>numChars</i> characters long.)   <b>Tcl_UtfNcmp</b> compares the two strings character-by-character according to the Unicode character ordering. It returns an integer greater than, equal to, or less than 0 if the first string is greater than, equal to, or less than the second string respectively.<div class="spacer">
</div>
<b>Tcl_UtfNcasecmp</b> corresponds to <b>strncasecmp</b> for UTF-8 strings.  It is similar to  <b>Tcl_UtfNcmp</b> except comparisons ignore differences in case when comparing upper, lower or title case characters.<div class="spacer">
</div>
<b>Tcl_UtfCharComplete</b> returns 1 if the source UTF-8 string <i>src</i> of  <i>length</i> bytes is long enough to be decoded by  <b>Tcl_UtfToUniChar</b>, or 0 otherwise.  This function does not guarantee that the UTF-8 string is properly formed.  This routine is used by procedures that are operating on a byte at a time and need to know if a full Tcl_UniChar has been seen.<div class="spacer">
</div>
<b>Tcl_NumUtfChars</b> corresponds to <b>strlen</b> for UTF-8 strings.  It returns the number of Tcl_UniChars that are represented by the UTF-8 string  <i>src</i>.  The length of the source string is <i>length</i> bytes.  If the length is negative, all bytes up to the first null byte are used.<div class="spacer">
</div>
<b>Tcl_UtfFindFirst</b> corresponds to <b>strchr</b> for UTF-8 strings.  It returns a pointer to the first occurrence of the Tcl_UniChar  <i>ch</i> in the null-terminated UTF-8 string  <i>src</i>.  The null terminator is considered part of the UTF-8 string.<div class="spacer">
</div>
<b>Tcl_UtfFindLast</b> corresponds to <b>strrchr</b> for UTF-8 strings.  It returns a pointer to the last occurrence of the Tcl_UniChar  <i>ch</i> in the null-terminated UTF-8 string  <i>src</i>.  The null terminator is considered part of the UTF-8 string.<div class="spacer">
</div>
Given <i>src</i>, a pointer to some location in a UTF-8 string,  <b>Tcl_UtfNext</b> returns a pointer to the next UTF-8 character in the string.  The caller must not ask for the next character after the last character in the string if the string is not terminated by a null character.<div class="spacer">
</div>
Given <i>src</i>, a pointer to some location in a UTF-8 string (or to a null byte immediately following such a string),  <b>Tcl_UtfPrev</b> returns a pointer to the closest preceding byte that starts a UTF-8 character. This function will not back up to a position before  <i>start</i>, the start of the UTF-8 string.  If  <i>src</i> was already at <i>start</i>, the return value will be  <i>start</i>.<div class="spacer">
</div>
<b>Tcl_UniCharAtIndex</b> corresponds to a C string array dereference or the Pascal Ord() function.  It returns the Tcl_UniChar represented at the specified character (not byte)  <i>index</i> in the UTF-8 string  <i>src</i>.  The source string must contain at least <i>index</i> characters.  Behavior is undefined if a negative  <i>index</i> is given.<div class="spacer">
</div>
<b>Tcl_UtfAtIndex</b> returns a pointer to the specified character (not byte)  <i>index</i> in the UTF-8 string <i>src</i>.  The source string must contain at least  <i>index</i> characters.  This is equivalent to calling  <b>Tcl_UtfNext</b> <i>index</i> times.  If a negative <i>index</i> is given, the return pointer points to the first character in the source string.<div class="spacer">
</div>
<b>Tcl_UtfBackslash</b> is a utility procedure used by several of the Tcl commands.  It parses a backslash sequence and stores the properly formed UTF-8 character represented by the backslash sequence in the output buffer  <i>dst</i>.  At most <b>TCL_UTF_MAX</b> bytes are stored in the buffer.  <b>Tcl_UtfBackslash</b> modifies <i>*readPtr</i> to contain the number of bytes in the backslash sequence, including the backslash character. The return value is the number of bytes stored in the output buffer.<div class="spacer">
</div>
See the <b>Tcl</b> manual entry for information on the valid backslash sequences.  All of the sequences described in the Tcl manual entry are supported by  <b>Tcl_UtfBackslash</b>.<div style="height: 1.00em;">
&#160;</div>
</div>
<div class="section">
<h1>KEYWORDS</h1> utf, unicode, backslash</div>
<table class="foot">
<tr>
<td class="foot-date">
8.1</td>
<td class="foot-os">
Tcl</td>
</tr>
</table>
</div>
</body>
</html>

