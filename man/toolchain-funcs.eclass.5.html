<!DOCTYPE html>
<html>
<head>
<meta charset="utf-8"/>
<style>
table.head, table.foot { width: 100%; }
td.head-rtitle, td.foot-os { text-align: right; }
td.head-vol { text-align: center; }
table.foot td { width: 50%; }
table.head td { width: 33%; }
div.spacer { margin: 1em 0; }
</style>
<title>
TOOLCHAIN-FUNCS.ECLASS(5)</title>
</head>
<body>
<div class="mandoc">
<table class="head">
<tbody>
<tr>
<td class="head-ltitle">
TOOLCHAIN-FUNCS.ECLASS(5)</td>
<td class="head-vol">
portage</td>
<td class="head-rtitle">
TOOLCHAIN-FUNCS.ECLASS(5)</td>
</tr>
</tbody>
</table>
<div class="section">
<h1>NAME</h1> toolchain-funcs.eclass - functions to query common info about the toolchain</div>
<div class="section">
<h1>DESCRIPTION</h1> The toolchain-funcs aims to provide a complete suite of functions for gleaning useful information about the toolchain and to simplify ugly things like cross-compiling and multilib.  All of this is done in such a way that you can rely on the function always returning something sane.</div>
<div class="section">
<h1>FUNCTIONS</h1><dl>
<dt>
<b>tc-getAR</b> [toolchain prefix]</dt>
<dd>
Return value: name of the archiver</dd>
</dl>
<dl>
<dt>
<b>tc-getAS</b> [toolchain prefix]</dt>
<dd>
Return value: name of the assembler</dd>
</dl>
<dl>
<dt>
<b>tc-getCC</b> [toolchain prefix]</dt>
<dd>
Return value: name of the C compiler</dd>
</dl>
<dl>
<dt>
<b>tc-getCPP</b> [toolchain prefix]</dt>
<dd>
Return value: name of the C preprocessor</dd>
</dl>
<dl>
<dt>
<b>tc-getCXX</b> [toolchain prefix]</dt>
<dd>
Return value: name of the C++ compiler</dd>
</dl>
<dl>
<dt>
<b>tc-getLD</b> [toolchain prefix]</dt>
<dd>
Return value: name of the linker</dd>
</dl>
<dl>
<dt>
<b>tc-getSTRIP</b> [toolchain prefix]</dt>
<dd>
Return value: name of the strip program</dd>
</dl>
<dl>
<dt>
<b>tc-getNM</b> [toolchain prefix]</dt>
<dd>
Return value: name of the symbol/object thingy</dd>
</dl>
<dl>
<dt>
<b>tc-getRANLIB</b> [toolchain prefix]</dt>
<dd>
Return value: name of the archiver indexer</dd>
</dl>
<dl>
<dt>
<b>tc-getOBJCOPY</b> [toolchain prefix]</dt>
<dd>
Return value: name of the object copier</dd>
</dl>
<dl>
<dt>
<b>tc-getOBJDUMP</b> [toolchain prefix]</dt>
<dd>
Return value: name of the object dumper</dd>
</dl>
<dl>
<dt>
<b>tc-getF77</b> [toolchain prefix]</dt>
<dd>
Return value: name of the Fortran 77 compiler</dd>
</dl>
<dl>
<dt>
<b>tc-getFC</b> [toolchain prefix]</dt>
<dd>
Return value: name of the Fortran 90 compiler</dd>
</dl>
<dl>
<dt>
<b>tc-getGCJ</b> [toolchain prefix]</dt>
<dd>
Return value: name of the java compiler</dd>
</dl>
<dl>
<dt>
<b>tc-getGO</b> [toolchain prefix]</dt>
<dd>
Return value: name of the Go compiler</dd>
</dl>
<dl>
<dt>
<b>tc-getPKG_CONFIG</b> [toolchain prefix]</dt>
<dd>
Return value: name of the pkg-config tool</dd>
</dl>
<dl>
<dt>
<b>tc-getRC</b> [toolchain prefix]</dt>
<dd>
Return value: name of the Windows resource compiler</dd>
</dl>
<dl>
<dt>
<b>tc-getDLLWRAP</b> [toolchain prefix]</dt>
<dd>
Return value: name of the Windows dllwrap utility</dd>
</dl>
<dl>
<dt>
<b>tc-getBUILD_AR</b> [toolchain prefix]</dt>
<dd>
Return value: name of the archiver for building binaries to run on the build machine</dd>
</dl>
<dl>
<dt>
<b>tc-getBUILD_AS</b> [toolchain prefix]</dt>
<dd>
Return value: name of the assembler for building binaries to run on the build machine</dd>
</dl>
<dl>
<dt>
<b>tc-getBUILD_CC</b> [toolchain prefix]</dt>
<dd>
Return value: name of the C compiler for building binaries to run on the build machine</dd>
</dl>
<dl>
<dt>
<b>tc-getBUILD_CPP</b> [toolchain prefix]</dt>
<dd>
Return value: name of the C preprocessor for building binaries to run on the build machine</dd>
</dl>
<dl>
<dt>
<b>tc-getBUILD_CXX</b> [toolchain prefix]</dt>
<dd>
Return value: name of the C++ compiler for building binaries to run on the build machine</dd>
</dl>
<dl>
<dt>
<b>tc-getBUILD_LD</b> [toolchain prefix]</dt>
<dd>
Return value: name of the linker for building binaries to run on the build machine</dd>
</dl>
<dl>
<dt>
<b>tc-getBUILD_STRIP</b> [toolchain prefix]</dt>
<dd>
Return value: name of the strip program for building binaries to run on the build machine</dd>
</dl>
<dl>
<dt>
<b>tc-getBUILD_NM</b> [toolchain prefix]</dt>
<dd>
Return value: name of the symbol/object thingy for building binaries to run on the build machine</dd>
</dl>
<dl>
<dt>
<b>tc-getBUILD_RANLIB</b> [toolchain prefix]</dt>
<dd>
Return value: name of the archiver indexer for building binaries to run on the build machine</dd>
</dl>
<dl>
<dt>
<b>tc-getBUILD_OBJCOPY</b> [toolchain prefix]</dt>
<dd>
Return value: name of the object copier for building binaries to run on the build machine</dd>
</dl>
<dl>
<dt>
<b>tc-getBUILD_PKG_CONFIG</b> [toolchain prefix]</dt>
<dd>
Return value: name of the pkg-config tool for building binaries to run on the build machine</dd>
</dl>
<dl>
<dt>
<b>tc-export</b> &lt;list of toolchain variables&gt;</dt>
<dd>
Quick way to export a bunch of compiler vars at once.</dd>
</dl>
<dl>
<dt>
<b>tc-is-cross-compiler</b></dt>
<dd>
Return value: Shell true if we are using a cross-compiler, shell false otherwise</dd>
</dl>
<dl>
<dt>
<b>tc-is-softfloat</b></dt>
<dd>
See if this toolchain is a softfloat based one.<br/>
The possible return values:<br/>
 - only:   the target is always softfloat (never had fpu)<br/>
 - yes:    the target should support softfloat<br/>
 - softfp: (arm specific) the target should use hardfloat insns, but softfloat calling convention<br/>
 - no:     the target doesn't support softfloat<br/>
This allows us to react differently where packages accept softfloat flags in the case where support is optional, but rejects softfloat flags where the target always lacks an fpu.</dd>
</dl>
<dl>
<dt>
<b>tc-is-static-only</b></dt>
<dd>
Return shell true if the target does not support shared libs, shell false otherwise.</dd>
</dl>
<dl>
<dt>
<b>tc-export_build_env</b> [compiler variables]</dt>
<dd>
Export common build related compiler settings.</dd>
</dl>
<dl>
<dt>
<b>econf_build</b> [econf flags]</dt>
<dd>
Sometimes we need to locally build up some tools to run on CBUILD because the package has helper utils which are compiled+executed when compiling. This won't work when cross-compiling as the CHOST is set to a target which we cannot natively execute.<div style="height: 1.00em;">
&#160;</div>
For example, the python package will build up a local python binary using a portable build system (configure+make), but then use that binary to run local python scripts to build up other components of the overall python. We cannot rely on the python binary in $PATH as that often times will be a different version, or not even installed in the first place.  Instead, we compile the code in a different directory to run on CBUILD, and then use that binary when compiling the main package to run on CHOST.<div style="height: 1.00em;">
&#160;</div>
For example, with newer EAPIs, you'd do something like:<br/>
src_configure() {<br/>
	ECONF_SOURCE=${S}<br/>
	if tc-is-cross-compiler ; then<br/>
		mkdir &quot;${WORKDIR}&quot;/${CBUILD}<br/>
		pushd &quot;${WORKDIR}&quot;/${CBUILD} &gt;/dev/null<br/>
		econf_build --disable-some-unused-stuff<br/>
		popd &gt;/dev/null<br/>
	fi<br/>
	... normal build paths ...<br/>
}<br/>
src_compile() {<br/>
	if tc-is-cross-compiler ; then<br/>
		pushd &quot;${WORKDIR}&quot;/${CBUILD} &gt;/dev/null<br/>
		emake one-or-two-build-tools<br/>
		ln/mv build-tools to normal build paths in ${S}/<br/>
		popd &gt;/dev/null<br/>
	fi<br/>
	... normal build paths ...<br/>
}<br/>
</dd>
</dl>
<dl>
<dt>
<b>tc-ld-is-gold</b> [toolchain prefix]</dt>
<dd>
Return true if the current linker is set to gold.</dd>
</dl>
<dl>
<dt>
<b>tc-ld-disable-gold</b> [toolchain prefix]</dt>
<dd>
If the gold linker is currently selected, configure the compilation settings so that we use the older bfd linker instead.</dd>
</dl>
<dl>
<dt>
<b>tc-has-openmp</b> [toolchain prefix]</dt>
<dd>
See if the toolchain supports OpenMP.</dd>
</dl>
<dl>
<dt>
<b>tc-has-tls</b> [-s|-c|-l] [toolchain prefix]</dt>
<dd>
See if the toolchain supports thread local storage (TLS).  Use -s to test the compiler, -c to also test the assembler, and -l to also test the C library (the default).</dd>
</dl>
<dl>
<dt>
<b>tc-arch-kernel</b> [toolchain prefix]</dt>
<dd>
Return value: name of the kernel arch according to the compiler target</dd>
</dl>
<dl>
<dt>
<b>tc-arch</b> [toolchain prefix]</dt>
<dd>
Return value: name of the portage arch according to the compiler target</dd>
</dl>
<dl>
<dt>
<b>gcc-fullversion</b></dt>
<dd>
Return value: compiler version (major.minor.micro: [3.4.6])</dd>
</dl>
<dl>
<dt>
<b>gcc-version</b></dt>
<dd>
Return value: compiler version (major.minor: [3.4].6)</dd>
</dl>
<dl>
<dt>
<b>gcc-major-version</b></dt>
<dd>
Return value: major compiler version (major: [3].4.6)</dd>
</dl>
<dl>
<dt>
<b>gcc-minor-version</b></dt>
<dd>
Return value: minor compiler version (minor: 3.[4].6)</dd>
</dl>
<dl>
<dt>
<b>gcc-micro-version</b></dt>
<dd>
Return value: micro compiler version (micro: 3.4.[6])</dd>
</dl>
<dl>
<dt>
<b>gen_usr_ldscript</b> [-a] &lt;list of libs to create linker scripts for&gt;</dt>
<dd>
This function generate linker scripts in /usr/lib for dynamic libs in /lib.  This is to fix linking problems when you have the .so in /lib, and the .a in /usr/lib.  What happens is that in some cases when linking dynamic, the .a in /usr/lib is used instead of the .so in /lib due to gcc/libtool tweaking ld's library search path.  This causes many builds to fail. See bug #4411 for more info.<div style="height: 1.00em;">
&#160;</div>
Note that you should in general use the unversioned name of the library (libfoo.so), as ldconfig should usually update it correctly to point to the latest version of the library present.</dd>
</dl>
</div>
<div class="section">
<h1>MAINTAINERS</h1><br/>
Toolchain Ninjas &lt;toolchain@gentoo.org&gt;<br/>
</div>
<div class="section">
<h1>REPORTING BUGS</h1> Please report bugs via http://bugs.gentoo.org/</div>
<div class="section">
<h1>FILES</h1> <b>/usr/portage/eclass/toolchain-funcs.eclass</b></div>
<div class="section">
<h1>SEE ALSO</h1> <b>ebuild</b>(5)<br/>
https://gitweb.gentoo.org/repo/gentoo.git/log/eclass/toolchain-funcs.eclass<br/>
</div>
<table class="foot">
<tr>
<td class="foot-date">
Aug 2015</td>
<td class="foot-os">
Portage</td>
</tr>
</table>
</div>
</body>
</html>

