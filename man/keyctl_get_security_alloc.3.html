<!DOCTYPE html>
<html>
<head>
<meta charset="utf-8"/>
<style>
table.head, table.foot { width: 100%; }
td.head-rtitle, td.foot-os { text-align: right; }
td.head-vol { text-align: center; }
table.foot td { width: 50%; }
table.head td { width: 33%; }
div.spacer { margin: 1em 0; }
</style>
<title>
KEYCTL_GET_SECURITY(3)</title>
</head>
<body>
<div class="mandoc">
<table class="head">
<tbody>
<tr>
<td class="head-ltitle">
KEYCTL_GET_SECURITY(3)</td>
<td class="head-vol">
Linux Key Management Calls</td>
<td class="head-rtitle">
KEYCTL_GET_SECURITY(3)</td>
</tr>
</tbody>
</table>
<div class="section">
<h1>NAME</h1> keyctl_get_security - Retrieve a key's security context</div>
<div class="section">
<h1>SYNOPSIS</h1> <b>#include &lt;keyutils.h&gt;</b><div style="height: 1.00em;">
&#160;</div>
<br/>
<b>long keyctl_get_security(key_serial_t </b><i>key</i><b>, char *</b><i>buffer</i><b>,</b><br/>
<b>size_t </b><i>buflen</i><b>);</b><div style="height: 1.00em;">
&#160;</div>
<br/>
<b>long keyctl_get_security_alloc(key_serial_t </b><i>key</i><b>, char **</b><i>_buffer</i><b>);</b></div>
<div class="section">
<h1>DESCRIPTION</h1> <b>keyctl_get_security</b>() retrieves the security context of a key as a NUL-terminated string.  This will be rendered in a form appropriate to the LSM in force - for instance, with SELinux, it may look like<dl>
<dt>
</dt>
<dd>
<b>unconfined_u:unconfined_r:unconfined_t:s0-s0:c0.c1023</b></dd>
</dl>
<div class="spacer">
</div>
The caller must have <b>view</b> permission on a key to be able to get its security context.<div class="spacer">
</div>
<i>buffer</i> and <i>buflen</i> specify the buffer into which the string will be placed.  If the buffer is too small, the full size of the string will be returned, and no copy will take place.<div class="spacer">
</div>
<b>keyctl_get_security_alloc</b>() is similar to <b>keyctl_get_security</b>() except that it allocates a buffer big enough to hold the string and copies the string into it.  If successful, A pointer to the buffer is placed in <i>*_buffer</i>. The caller must free the buffer.</div>
<div class="section">
<h1>RETURN VALUE</h1> On success <b>keyctl_get_security</b>() returns the amount of data placed into the buffer.  If the buffer was too small, then the size of buffer required will be returned, but no data will be transferred.  On error, the value <b>-1</b> will be returned and errno will have been set to an appropriate error.<div class="spacer">
</div>
On success <b>keyctl_get_security_alloc</b>() returns the amount of data in the buffer, less the NUL terminator.  On error, the value <b>-1</b> will be returned and errno will have been set to an appropriate error.</div>
<div class="section">
<h1>ERRORS</h1><dl>
<dt>
<b>ENOKEY</b></dt>
<dd>
The key specified is invalid.</dd>
</dl>
<dl>
<dt>
<b>EKEYEXPIRED</b></dt>
<dd>
The key specified has expired.</dd>
</dl>
<dl>
<dt>
<b>EKEYREVOKED</b></dt>
<dd>
The key specified had been revoked.</dd>
</dl>
<dl>
<dt>
<b>EACCES</b></dt>
<dd>
The key exists, but is not <b>viewable</b> by the calling process.</dd>
</dl>
</div>
<div class="section">
<h1>LINKING</h1> This is a library function that can be found in <i>libkeyutils</i>. When linking, <b>-lkeyutils</b> should be specified to the linker.</div>
<div class="section">
<h1>SEE ALSO</h1> <b>keyctl</b>(1),<div style="height: 0.00em;">
&#160;</div>
<b>add_key</b>(2),<div style="height: 0.00em;">
&#160;</div>
<b>keyctl</b>(2),<div style="height: 0.00em;">
&#160;</div>
<b>request_key</b>(2),<div style="height: 0.00em;">
&#160;</div>
<b>keyctl</b>(3),<div style="height: 0.00em;">
&#160;</div>
<b>keyutils</b>(7),<div style="height: 0.00em;">
&#160;</div>
<b>keyrings</b>(7)</div>
<table class="foot">
<tr>
<td class="foot-date">
26 Feb 2010</td>
<td class="foot-os">
Linux</td>
</tr>
</table>
</div>
</body>
</html>

